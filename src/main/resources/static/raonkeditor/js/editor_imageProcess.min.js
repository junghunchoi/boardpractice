importScripts("editor_imageExif.js");function processFile(a){var b=ExifRestorer.restore2(a.imageOriginalData,a.imageNewData);if(b){0>b.indexOf("data:image/jpeg;base64,")&&(b="data:image/jpeg;base64,"+b);var c=dataURItoBlob(b);a={workerIdx:a.workerIdx,fileIdx:a.fileIdx,newBlob:c,newData:b};self.postMessage({type:"complete",sendData:a})}else a={workerIdx:a.workerIdx,fileIdx:a.fildIdx},self.postMessage({type:"error",sendData:a})}self.onmessage=function(a){a=a.data;switch(a.type){case "start":processFile(a.sendData)}};
function dataURItoBlob(a){var b=atob(a.split(",")[1]);a=a.split(",")[0].split(":")[1].split(";")[0];for(var c=new ArrayBuffer(b.length),e=new Uint8Array(c),d=0;d<b.length;d++)e[d]=b.charCodeAt(d);b=new DataView(c);return new Blob([b.buffer],{type:a})};
